---
  parameters:
  - name: appname
    default: demo
  - name: instance_type
    default: t2.xlarge #t2.micro
  - name: vpc
    cloudtype: AWS::EC2::VPC::Id
    default: <%= MU.myVPC %>
    
appname: <%= appname %>
servers:
  -
    name: gitlab
    ssh_user: ubuntu
    platform: ubuntu
    storage:
      -
        size: 16
    skipinitialupdates: true
    size: <%= instance_type %>
    run_list:
    - recipe[demo::gitlab]
    - recipe[demo::gitlab_runner]
    associate_public_ip: true
    static_ip: 
      assign_ip: true
      vpc:
        vpc_id: <%= vpc %>
        subnet_pref: public
    ingress_rules:
      -
        port: 80
        hosts:
          - "0.0.0.0/0"
      -
        port: 443
        hosts:
          - "0.0.0.0/0"